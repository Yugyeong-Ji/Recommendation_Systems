# Item2Vec_yelp18_x0

A notebook to benchmark Item2Vec on yelp18 dataset.

Author: Yi Li, Tsinghua University

Edited by [XUEPAI Team](https://github.com/xue-pai)

### Index

[Environments](#Environments) | [Dataset](#Dataset) | [Code](#Code) | [Results](#Results)| [Logs](#Logs) 

### Environments

* Hardware

```shell
CPU: Intel(R) Xeon(R) Silver 4210R CPU @ 2.40GHz
RAM: 125G
GPU: GeForce RTX 2080Ti, 11G memory
```

* Software

```shell
python: 3.6.2
pytorch: 1.1.0
torchvision: 0.3.0
```

### Dataset

We directly use the `yelp2018` dataset provided in their [repo](https://github.com/kuandeng/LightGCN/tree/master/Data). So you can put the `train.txt` and `test.txt` in the corresponding data set downloaded from the [LightGCN repo](https://github.com/kuandeng/LightGCN/tree/master/Data) into the data/Yelp18/yelp18_x0 directory.

### Code

1. This benchmark is implemented based on a public repository for the recommendation, daisyRec: https://github.com/AmazingDD/daisyRec/tree/dff66b71a4d360eae7bf4edec5df1d4941937cb2. We use the version with commit hash: dff66b7.

2. Based on the Item2Vec model defined in the  [daisyRec repo](https://github.com/AmazingDD/daisyRec/blob/dev/daisy/model/Item2VecRecommender.py), we perform data processing, model call and metrics calculation in the `Item2Vec.py` file.

3. Run the following script to reproduce the result.

   ```shell
   python Item2Vec.py --dataset Yelp18 --window 20 --n_neg 50 --batch_size 1024 --gpu_id 2
   ```

   

### Results

```
HR@20 = 0.32670, Recall@20 = 0.05033, NDCG@20 = 0.04110
HR@50 = 0.51136, Recall@50 = 0.09709, NDCG@50 = 0.05851
```

### Logs

```shell
Namespace(batch_size=1024, dataset='Yelp18', emb_dim=64, epochs=200, n_negs=50, topk='[20, 50]', window=20, gpu_id=2)
building vocab...
build done
converting train by corpus build before...
conversion done
model fitting...
[Epoch 1]: 100%|█████████████████████████████████████████████████████████████████| 1209/1209 [02:21<00:00,  8.55it/s, loss=3.65]
[Epoch 2]: 100%|█████████████████████████████████████████████████████████████████| 1209/1209 [02:29<00:00,  8.11it/s, loss=3.38]
[Epoch 3]: 100%|█████████████████████████████████████████████████████████████████| 1209/1209 [02:19<00:00,  8.65it/s, loss=3.29]
[Epoch 4]: 100%|█████████████████████████████████████████████████████████████████| 1209/1209 [02:14<00:00,  8.96it/s, loss=2.99]
[Epoch 5]: 100%|██████████████████████████████████████████████████████████████████| 1209/1209 [02:21<00:00,  8.53it/s, loss=2.7]
[Epoch 6]: 100%|█████████████████████████████████████████████████████████████████| 1209/1209 [02:19<00:00,  8.69it/s, loss=2.68]
[Epoch 7]: 100%|█████████████████████████████████████████████████████████████████| 1209/1209 [02:23<00:00,  8.43it/s, loss=2.39]
[Epoch 8]: 100%|█████████████████████████████████████████████████████████████████| 1209/1209 [02:34<00:00,  7.84it/s, loss=2.34]
[Epoch 9]: 100%|██████████████████████████████████████████████████████████████████| 1209/1209 [02:42<00:00,  7.43it/s, loss=2.3]
[Epoch 10]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:31<00:00,  7.97it/s, loss=2.35]
[Epoch 11]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:33<00:00,  7.90it/s, loss=2.31]
[Epoch 12]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:30<00:00,  8.05it/s, loss=2.32]
[Epoch 13]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:35<00:00,  7.76it/s, loss=2.25]
[Epoch 14]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:38<00:00,  7.61it/s, loss=2.39]
[Epoch 15]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:41<00:00,  7.49it/s, loss=2.54]
[Epoch 16]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:41<00:00,  7.49it/s, loss=2.19]
[Epoch 17]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:47<00:00,  7.20it/s, loss=2.46]
[Epoch 18]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:29<00:00,  8.08it/s, loss=2.39]
[Epoch 19]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:32<00:00,  7.95it/s, loss=2.25]
[Epoch 20]: 100%|█████████████████████████████████████████████████████████████████| 1209/1209 [02:28<00:00,  8.12it/s, loss=2.2]
[Epoch 21]: 100%|█████████████████████████████████████████████████████████████████| 1209/1209 [02:37<00:00,  7.69it/s, loss=2.2]
[Epoch 22]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:26<00:00,  8.24it/s, loss=2.29]
[Epoch 23]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:34<00:00,  7.82it/s, loss=2.33]
[Epoch 24]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:29<00:00,  8.07it/s, loss=2.18]
[Epoch 25]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:34<00:00,  7.81it/s, loss=2.34]
[Epoch 26]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:29<00:00,  8.07it/s, loss=2.22]
[Epoch 27]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:31<00:00,  7.99it/s, loss=2.31]
[Epoch 28]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:30<00:00,  8.03it/s, loss=2.19]
[Epoch 29]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:34<00:00,  7.81it/s, loss=2.12]
[Epoch 30]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:26<00:00,  8.25it/s, loss=2.31]
[Epoch 31]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:31<00:00,  7.99it/s, loss=2.24]
[Epoch 32]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:32<00:00,  7.91it/s, loss=2.46]
[Epoch 33]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:33<00:00,  7.88it/s, loss=2.22]
[Epoch 34]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:32<00:00,  7.91it/s, loss=2.21]
[Epoch 35]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:32<00:00,  7.94it/s, loss=2.29]
[Epoch 36]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:31<00:00,  7.96it/s, loss=2.28]
[Epoch 37]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:34<00:00,  7.81it/s, loss=2.16]
[Epoch 38]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:30<00:00,  8.01it/s, loss=2.13]
[Epoch 39]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:37<00:00,  7.70it/s, loss=2.14]
[Epoch 40]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:30<00:00,  8.03it/s, loss=2.27]
[Epoch 41]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:28<00:00,  8.14it/s, loss=2.27]
[Epoch 42]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:32<00:00,  7.95it/s, loss=2.26]
[Epoch 43]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:30<00:00,  8.04it/s, loss=2.22]
[Epoch 44]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:35<00:00,  7.75it/s, loss=2.08]
[Epoch 45]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:36<00:00,  7.72it/s, loss=2.29]
[Epoch 46]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:33<00:00,  7.85it/s, loss=2.18]
[Epoch 47]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:33<00:00,  7.88it/s, loss=2.09]
[Epoch 48]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:33<00:00,  7.89it/s, loss=2.17]
[Epoch 49]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:29<00:00,  8.11it/s, loss=2.24]
[Epoch 50]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:33<00:00,  7.87it/s, loss=2.15]
[Epoch 51]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:29<00:00,  8.08it/s, loss=2.18]
[Epoch 52]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:33<00:00,  7.88it/s, loss=2.13]
[Epoch 53]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:29<00:00,  8.10it/s, loss=2.11]
[Epoch 54]: 100%|█████████████████████████████████████████████████████████████████| 1209/1209 [02:34<00:00,  7.83it/s, loss=2.1]
[Epoch 55]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:29<00:00,  8.09it/s, loss=2.13]
[Epoch 56]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:29<00:00,  8.10it/s, loss=2.14]
[Epoch 57]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:32<00:00,  7.90it/s, loss=2.12]
[Epoch 58]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:33<00:00,  7.86it/s, loss=2.14]
[Epoch 59]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:32<00:00,  7.95it/s, loss=2.16]
[Epoch 60]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:31<00:00,  8.00it/s, loss=2.13]
[Epoch 61]: 100%|█████████████████████████████████████████████████████████████████| 1209/1209 [02:32<00:00,  7.91it/s, loss=2.2]
[Epoch 62]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:28<00:00,  8.14it/s, loss=2.17]
[Epoch 63]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:30<00:00,  8.05it/s, loss=2.25]
[Epoch 64]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:34<00:00,  7.82it/s, loss=2.15]
[Epoch 65]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:35<00:00,  7.76it/s, loss=2.23]
[Epoch 66]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:32<00:00,  7.94it/s, loss=2.17]
[Epoch 67]: 100%|█████████████████████████████████████████████████████████████████| 1209/1209 [02:31<00:00,  7.98it/s, loss=2.2]
[Epoch 68]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:31<00:00,  7.97it/s, loss=2.27]
[Epoch 69]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:26<00:00,  8.24it/s, loss=2.08]
[Epoch 70]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:33<00:00,  7.88it/s, loss=2.08]
[Epoch 71]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:28<00:00,  8.13it/s, loss=2.13]
[Epoch 72]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:34<00:00,  7.81it/s, loss=2.15]
[Epoch 73]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:30<00:00,  8.05it/s, loss=2.16]
[Epoch 74]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:34<00:00,  7.81it/s, loss=2.19]
[Epoch 75]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:31<00:00,  7.96it/s, loss=2.09]
[Epoch 76]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:39<00:00,  7.60it/s, loss=2.06]
[Epoch 77]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:40<00:00,  7.54it/s, loss=2.12]
[Epoch 78]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:45<00:00,  7.29it/s, loss=2.18]
[Epoch 79]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:36<00:00,  7.73it/s, loss=2.07]
[Epoch 80]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:57<00:00,  6.82it/s, loss=2.29]
[Epoch 81]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:48<00:00,  7.16it/s, loss=2.09]
[Epoch 82]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:26<00:00,  8.23it/s, loss=2.46]
[Epoch 83]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:28<00:00,  8.15it/s, loss=2.15]
[Epoch 84]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:28<00:00,  8.12it/s, loss=2.13]
[Epoch 85]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:22<00:00,  8.49it/s, loss=2.17]
[Epoch 86]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:22<00:00,  8.47it/s, loss=2.21]
[Epoch 87]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:24<00:00,  8.37it/s, loss=2.09]
[Epoch 88]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:23<00:00,  8.41it/s, loss=2.42]
[Epoch 89]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:22<00:00,  8.47it/s, loss=2.13]
[Epoch 90]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:24<00:00,  8.36it/s, loss=2.24]
[Epoch 91]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:25<00:00,  8.33it/s, loss=2.16]
[Epoch 92]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:48<00:00,  7.20it/s, loss=2.16]
[Epoch 93]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [03:12<00:00,  6.27it/s, loss=2.12]
[Epoch 94]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:43<00:00,  7.38it/s, loss=2.15]
[Epoch 95]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:44<00:00,  7.37it/s, loss=2.08]
[Epoch 96]: 100%|█████████████████████████████████████████████████████████████████| 1209/1209 [02:33<00:00,  7.85it/s, loss=2.1]
[Epoch 97]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:31<00:00,  7.96it/s, loss=2.38]
[Epoch 98]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:28<00:00,  8.13it/s, loss=2.12]
[Epoch 99]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:23<00:00,  8.45it/s, loss=2.12]
[Epoch 100]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:24<00:00,  8.37it/s, loss=2.19]
[Epoch 101]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:43<00:00,  7.40it/s, loss=2.16]
[Epoch 102]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:32<00:00,  7.93it/s, loss=2.17]
[Epoch 103]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:30<00:00,  8.01it/s, loss=2.07]
[Epoch 104]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:30<00:00,  8.03it/s, loss=2.4]
[Epoch 105]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:43<00:00,  7.40it/s, loss=2.09]
[Epoch 106]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:28<00:00,  8.14it/s, loss=2.31]
[Epoch 107]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:33<00:00,  7.90it/s, loss=2.05]
[Epoch 108]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:33<00:00,  7.86it/s, loss=2.1]
[Epoch 109]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:35<00:00,  7.77it/s, loss=2.22]
[Epoch 110]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:28<00:00,  8.14it/s, loss=2.18]
[Epoch 111]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:31<00:00,  7.96it/s, loss=2.26]
[Epoch 112]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:35<00:00,  7.79it/s, loss=2.28]
[Epoch 113]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:35<00:00,  7.78it/s, loss=2.1]
[Epoch 114]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:36<00:00,  7.74it/s, loss=2.2]
[Epoch 115]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:30<00:00,  8.01it/s, loss=2.16]
[Epoch 116]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:28<00:00,  8.13it/s, loss=2.14]
[Epoch 117]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:30<00:00,  8.06it/s, loss=2.18]
[Epoch 118]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:29<00:00,  8.08it/s, loss=2.07]
[Epoch 119]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:29<00:00,  8.09it/s, loss=2.28]
[Epoch 120]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:34<00:00,  7.83it/s, loss=2.08]
[Epoch 121]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:30<00:00,  8.01it/s, loss=2.27]
[Epoch 122]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:34<00:00,  7.82it/s, loss=2.2]
[Epoch 123]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:29<00:00,  8.11it/s, loss=2.06]
[Epoch 124]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:35<00:00,  7.76it/s, loss=2.26]
[Epoch 125]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:33<00:00,  7.87it/s, loss=2.29]
[Epoch 126]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:29<00:00,  8.08it/s, loss=2.24]
[Epoch 127]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:28<00:00,  8.17it/s, loss=2.16]
[Epoch 128]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:28<00:00,  8.15it/s, loss=2.19]
[Epoch 129]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:34<00:00,  7.83it/s, loss=2.18]
[Epoch 130]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:32<00:00,  7.92it/s, loss=2.14]
[Epoch 131]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:33<00:00,  7.88it/s, loss=2.16]
[Epoch 132]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:29<00:00,  8.11it/s, loss=2.28]
[Epoch 133]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:38<00:00,  7.64it/s, loss=2.31]
[Epoch 134]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [03:02<00:00,  6.63it/s, loss=2.37]
[Epoch 135]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [03:02<00:00,  6.63it/s, loss=2.07]
[Epoch 136]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:55<00:00,  6.87it/s, loss=2.26]
[Epoch 137]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:32<00:00,  7.92it/s, loss=2.15]
[Epoch 138]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:32<00:00,  7.92it/s, loss=2.16]
[Epoch 139]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:28<00:00,  8.15it/s, loss=2.07]
[Epoch 140]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:28<00:00,  8.15it/s, loss=2.1]
[Epoch 141]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:32<00:00,  7.90it/s, loss=2.17]
[Epoch 142]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:30<00:00,  8.03it/s, loss=2.28]
[Epoch 143]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:30<00:00,  8.04it/s, loss=2.26]
[Epoch 144]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:24<00:00,  8.39it/s, loss=2.22]
[Epoch 145]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:25<00:00,  8.33it/s, loss=2.09]
[Epoch 146]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:20<00:00,  8.59it/s, loss=2.23]
[Epoch 147]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:21<00:00,  8.56it/s, loss=2.22]
[Epoch 148]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:24<00:00,  8.39it/s, loss=2.17]
[Epoch 149]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:23<00:00,  8.42it/s, loss=2.22]
[Epoch 150]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:26<00:00,  8.24it/s, loss=2.18]
[Epoch 151]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:22<00:00,  8.46it/s, loss=2.09]
[Epoch 152]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:23<00:00,  8.40it/s, loss=2.21]
[Epoch 153]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:21<00:00,  8.52it/s, loss=2.16]
[Epoch 154]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:25<00:00,  8.32it/s, loss=2.14]
[Epoch 155]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:18<00:00,  8.74it/s, loss=2.14]
[Epoch 156]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:19<00:00,  8.66it/s, loss=2.12]
[Epoch 157]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:22<00:00,  8.47it/s, loss=2.07]
[Epoch 158]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:22<00:00,  8.49it/s, loss=2.06]
[Epoch 159]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:25<00:00,  8.32it/s, loss=2.21]
[Epoch 160]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:20<00:00,  8.63it/s, loss=2.11]
[Epoch 161]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:26<00:00,  8.26it/s, loss=2.23]
[Epoch 162]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:23<00:00,  8.44it/s, loss=2.13]
[Epoch 163]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:22<00:00,  8.47it/s, loss=2.12]
[Epoch 164]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:17<00:00,  8.80it/s, loss=2.28]
[Epoch 165]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:23<00:00,  8.42it/s, loss=2.21]
[Epoch 166]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:21<00:00,  8.53it/s, loss=2.16]
[Epoch 167]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:20<00:00,  8.62it/s, loss=2.03]
[Epoch 168]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:24<00:00,  8.36it/s, loss=2.11]
[Epoch 169]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:27<00:00,  8.21it/s, loss=2.13]
[Epoch 170]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:25<00:00,  8.33it/s, loss=2.13]
[Epoch 171]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:26<00:00,  8.28it/s, loss=2.12]
[Epoch 172]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:20<00:00,  8.58it/s, loss=2.16]
[Epoch 173]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:23<00:00,  8.41it/s, loss=2.25]
[Epoch 174]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:23<00:00,  8.43it/s, loss=2.09]
[Epoch 175]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:24<00:00,  8.36it/s, loss=2.17]
[Epoch 176]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:25<00:00,  8.29it/s, loss=2.47]
[Epoch 177]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:24<00:00,  8.36it/s, loss=2.14]
[Epoch 178]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:21<00:00,  8.55it/s, loss=2.08]
[Epoch 179]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:20<00:00,  8.62it/s, loss=2.1]
[Epoch 180]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:21<00:00,  8.55it/s, loss=2.08]
[Epoch 181]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:20<00:00,  8.59it/s, loss=2.12]
[Epoch 182]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:25<00:00,  8.33it/s, loss=2.28]
[Epoch 183]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:25<00:00,  8.30it/s, loss=2.09]
[Epoch 184]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:28<00:00,  8.17it/s, loss=2.18]
[Epoch 185]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:21<00:00,  8.55it/s, loss=2.11]
[Epoch 186]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:22<00:00,  8.45it/s, loss=2.1]
[Epoch 187]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:26<00:00,  8.25it/s, loss=2.14]
[Epoch 188]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:25<00:00,  8.33it/s, loss=2.13]
[Epoch 189]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:24<00:00,  8.37it/s, loss=2.12]
[Epoch 190]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:21<00:00,  8.52it/s, loss=2.3]
[Epoch 191]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:24<00:00,  8.38it/s, loss=2.12]
[Epoch 192]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:25<00:00,  8.32it/s, loss=2.15]
[Epoch 193]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:23<00:00,  8.44it/s, loss=2.09]
[Epoch 194]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:21<00:00,  8.55it/s, loss=2.2]
[Epoch 195]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:21<00:00,  8.52it/s, loss=2.3]
[Epoch 196]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:24<00:00,  8.35it/s, loss=2.22]
[Epoch 197]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:22<00:00,  8.48it/s, loss=2.35]
[Epoch 198]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:21<00:00,  8.55it/s, loss=2.13]
[Epoch 199]: 100%|████████████████████████████████████████████████████████████████| 1209/1209 [02:24<00:00,  8.35it/s, loss=2.3]
[Epoch 200]: 100%|███████████████████████████████████████████████████████████████| 1209/1209 [02:20<00:00,  8.60it/s, loss=2.23]
2021-03-10 20:18:20.094727, 0 ok, hit = 1
2021-03-10 21:09:45.276147, 2000 ok, hit = 2536
2021-03-10 21:56:56.284433, 4000 ok, hit = 4698
2021-03-10 22:41:58.947379, 6000 ok, hit = 6730
2021-03-10 23:18:39.491859, 8000 ok, hit = 8558
2021-03-10 23:55:26.224111, 10000 ok, hit = 10387
2021-03-11 00:32:16.499075, 12000 ok, hit = 12164
2021-03-11 01:06:56.956539, 14000 ok, hit = 13817
2021-03-11 01:38:42.863653, 16000 ok, hit = 15468
2021-03-11 02:10:30.784977, 18000 ok, hit = 16989
2021-03-11 02:43:19.647910, 20000 ok, hit = 18551
2021-03-11 03:11:26.832566, 22000 ok, hit = 20146
2021-03-11 03:37:42.173196, 24000 ok, hit = 21676
2021-03-11 04:03:58.683474, 26000 ok, hit = 23301
2021-03-11 04:30:14.670680, 28000 ok, hit = 24968
2021-03-11 04:56:38.319175, 30000 ok, hit = 26568
HR@20 = 0.3267020335985853, Recall@20 = 0.05032631730614718, NDCG@20 = 0.04109666244480014, HR@50 = 0.5113679424024251, Recall@50 = 0.09708929533286893, NDCG@50 = 0.05851034633165242
```



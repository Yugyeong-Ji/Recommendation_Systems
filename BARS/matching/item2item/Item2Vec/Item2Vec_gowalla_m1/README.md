# Item2Vec_gowalla_x0

A notebook to benchmark Item2Vec on gowalla_x0 dataset.

Author: Yi Li, Tsinghua University

Edited by [XUEPAI Team](https://github.com/xue-pai)

### Index

[Environments](#Environments) | [Dataset](#Dataset) | [Code](#Code) |[Results](#Results)| [Logs](#Logs) 

### Environments

* Hardware

```shell
CPU: Intel(R) Xeon(R) Silver 4210R CPU @ 2.40GHz
RAM: 125G
GPU: GeForce RTX 2080Ti, 11G memory
```

* Software

```shell
python: 3.6.2
pytorch: 1.1.0
torchvision: 0.3.0
```

### Dataset

We directly use the `gowalla` dataset provided in their [repo](https://github.com/newlei/LR-GCCF/tree/master/data/gowalla). So you can put the `train.txt` and `test.txt` in the corresponding data set downloaded from the [LightGCN repo](https://github.com/kuandeng/LightGCN/tree/master/Data) into the data/Gowalla/gowalla_x0 directory.

### Code

1. This benchmark is implemented based on a public repository for the recommendation, daisyRec: https://github.com/AmazingDD/daisyRec/tree/dff66b71a4d360eae7bf4edec5df1d4941937cb2. We use the version with commit hash: dff66b7.

2. Based on the Item2Vec model defined in the  [daisyRec repo](https://github.com/AmazingDD/daisyRec/blob/dev/daisy/model/Item2VecRecommender.py), we perform data processing, model call and metrics calculation in the `Item2Vec.py` file.

3. Run the following script to reproduce the result.

   ```shell
   python Item2Vec.py --dataset Gowalla --window 20 --n_negs 50 --batch_size 1024 --gpu_id 0
   ```

### Results

```
HR@20 = 0.47431, Recall@20 = 0.13259, NDCG@20 = 0.10573
HR@50 = 0.61876, Recall@50 = 0.21578, NDCG@50 = 0.13201
```

### Logs

```shell
Namespace(batch_size=1024, dataset='Gowalla', emb_dim=64, epochs=200, n_negs=50, topk='[20, 50]', window=20, gpu_id=0)
building vocab...
build done
converting train by corpus build before...
conversion done
model fitting...
[Epoch 1]: 100%|███████████████████████████████████████████████████████████████████| 792/792 [01:11<00:00, 11.12it/s, loss=4.39]
[Epoch 2]: 100%|███████████████████████████████████████████████████████████████████| 792/792 [01:06<00:00, 11.87it/s, loss=3.33]
[Epoch 3]: 100%|███████████████████████████████████████████████████████████████████| 792/792 [01:11<00:00, 11.07it/s, loss=3.03]
[Epoch 4]: 100%|███████████████████████████████████████████████████████████████████| 792/792 [01:09<00:00, 11.33it/s, loss=3.35]
[Epoch 5]: 100%|███████████████████████████████████████████████████████████████████| 792/792 [01:08<00:00, 11.54it/s, loss=3.26]
[Epoch 6]: 100%|███████████████████████████████████████████████████████████████████| 792/792 [01:27<00:00,  9.03it/s, loss=2.83]
[Epoch 7]: 100%|███████████████████████████████████████████████████████████████████| 792/792 [01:33<00:00,  8.50it/s, loss=2.73]
[Epoch 8]: 100%|███████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.65it/s, loss=2.56]
[Epoch 9]: 100%|███████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.74it/s, loss=2.29]
[Epoch 10]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:35<00:00,  8.33it/s, loss=2.36]
[Epoch 11]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.66it/s, loss=2.42]
[Epoch 12]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:34<00:00,  8.38it/s, loss=2.14]
[Epoch 13]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:33<00:00,  8.51it/s, loss=1.92]
[Epoch 14]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:28<00:00,  9.00it/s, loss=1.97]
[Epoch 15]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.72it/s, loss=1.96]
[Epoch 16]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:34<00:00,  8.42it/s, loss=1.92]
[Epoch 17]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.74it/s, loss=2.01]
[Epoch 18]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.55it/s, loss=1.87]
[Epoch 19]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:33<00:00,  8.46it/s, loss=1.84]
[Epoch 20]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.53it/s, loss=1.74]
[Epoch 21]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:35<00:00,  8.30it/s, loss=1.87]
[Epoch 22]: 100%|█████████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.55it/s, loss=2]
[Epoch 23]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.59it/s, loss=1.81]
[Epoch 24]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.63it/s, loss=2.04]
[Epoch 25]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:29<00:00,  8.82it/s, loss=2.13]
[Epoch 26]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.54it/s, loss=1.81]
[Epoch 27]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:36<00:00,  8.23it/s, loss=1.63]
[Epoch 28]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:39<00:00,  7.97it/s, loss=1.79]
[Epoch 29]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.52it/s, loss=1.83]
[Epoch 30]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.55it/s, loss=1.81]
[Epoch 31]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.63it/s, loss=1.76]
[Epoch 32]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.60it/s, loss=1.77]
[Epoch 33]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.63it/s, loss=1.79]
[Epoch 34]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.60it/s, loss=1.75]
[Epoch 35]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.61it/s, loss=1.75]
[Epoch 36]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:36<00:00,  8.17it/s, loss=1.68]
[Epoch 37]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.63it/s, loss=1.91]
[Epoch 38]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:29<00:00,  8.82it/s, loss=1.67]
[Epoch 39]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:36<00:00,  8.20it/s, loss=1.73]
[Epoch 40]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:34<00:00,  8.37it/s, loss=1.72]
[Epoch 41]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:35<00:00,  8.32it/s, loss=1.99]
[Epoch 42]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:33<00:00,  8.47it/s, loss=1.85]
[Epoch 43]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:29<00:00,  8.86it/s, loss=1.68]
[Epoch 44]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.71it/s, loss=1.66]
[Epoch 45]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.56it/s, loss=1.72]
[Epoch 46]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:29<00:00,  8.81it/s, loss=1.68]
[Epoch 47]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:37<00:00,  8.09it/s, loss=1.61]
[Epoch 48]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:37<00:00,  8.11it/s, loss=1.73]
[Epoch 49]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:37<00:00,  8.16it/s, loss=1.99]
[Epoch 50]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:34<00:00,  8.39it/s, loss=1.57]
[Epoch 51]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:37<00:00,  8.14it/s, loss=1.78]
[Epoch 52]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:33<00:00,  8.50it/s, loss=1.64]
[Epoch 53]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.74it/s, loss=1.71]
[Epoch 54]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.74it/s, loss=1.63]
[Epoch 55]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.77it/s, loss=1.98]
[Epoch 56]: 100%|█████████████████████████████████████████████████████████████████████| 792/792 [01:34<00:00,  8.39it/s, loss=2]
[Epoch 57]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:28<00:00,  8.90it/s, loss=1.72]
[Epoch 58]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:33<00:00,  8.45it/s, loss=1.69]
[Epoch 59]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:35<00:00,  8.29it/s, loss=1.62]
[Epoch 60]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:37<00:00,  8.11it/s, loss=1.55]
[Epoch 61]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:41<00:00,  7.77it/s, loss=1.58]
[Epoch 62]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:33<00:00,  8.47it/s, loss=1.61]
[Epoch 63]: 100%|███████████████████████████████████████████████████████████████████| 792/792 [01:38<00:00,  8.08it/s, loss=2.1]
[Epoch 64]: 100%|███████████████████████████████████████████████████████████████████| 792/792 [01:35<00:00,  8.28it/s, loss=1.7]
[Epoch 65]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:39<00:00,  7.96it/s, loss=1.59]
[Epoch 66]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:34<00:00,  8.40it/s, loss=1.75]
[Epoch 67]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.56it/s, loss=1.61]
[Epoch 68]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:29<00:00,  8.87it/s, loss=1.55]
[Epoch 69]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:29<00:00,  8.81it/s, loss=1.68]
[Epoch 70]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.54it/s, loss=1.59]
[Epoch 71]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.67it/s, loss=1.55]
[Epoch 72]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.76it/s, loss=1.83]
[Epoch 73]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.62it/s, loss=1.61]
[Epoch 74]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:33<00:00,  8.49it/s, loss=1.83]
[Epoch 75]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:28<00:00,  8.95it/s, loss=1.63]
[Epoch 76]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:34<00:00,  8.34it/s, loss=1.59]
[Epoch 77]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:34<00:00,  8.42it/s, loss=1.53]
[Epoch 78]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.62it/s, loss=1.53]
[Epoch 79]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:36<00:00,  8.17it/s, loss=1.64]
[Epoch 80]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.56it/s, loss=1.72]
[Epoch 81]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:35<00:00,  8.33it/s, loss=1.56]
[Epoch 82]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:35<00:00,  8.30it/s, loss=1.86]
[Epoch 83]: 100%|███████████████████████████████████████████████████████████████████| 792/792 [01:35<00:00,  8.30it/s, loss=1.8]
[Epoch 84]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:38<00:00,  8.02it/s, loss=1.62]
[Epoch 85]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.62it/s, loss=1.68]
[Epoch 86]: 100%|███████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.52it/s, loss=1.7]
[Epoch 87]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.70it/s, loss=1.63]
[Epoch 88]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.68it/s, loss=1.87]
[Epoch 89]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.56it/s, loss=1.63]
[Epoch 90]: 100%|███████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.69it/s, loss=1.5]
[Epoch 91]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.73it/s, loss=1.51]
[Epoch 92]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:28<00:00,  8.96it/s, loss=1.92]
[Epoch 93]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:34<00:00,  8.40it/s, loss=1.71]
[Epoch 94]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:29<00:00,  8.83it/s, loss=1.77]
[Epoch 95]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.75it/s, loss=1.65]
[Epoch 96]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.58it/s, loss=1.85]
[Epoch 97]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.79it/s, loss=1.61]
[Epoch 98]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:35<00:00,  8.27it/s, loss=1.89]
[Epoch 99]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:39<00:00,  7.97it/s, loss=1.71]
[Epoch 100]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:35<00:00,  8.27it/s, loss=1.63]
[Epoch 101]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.60it/s, loss=1.64]
[Epoch 102]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:29<00:00,  8.83it/s, loss=1.68]
[Epoch 103]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:27<00:00,  9.00it/s, loss=1.64]
[Epoch 104]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:34<00:00,  8.39it/s, loss=1.65]
[Epoch 105]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.66it/s, loss=1.93]
[Epoch 106]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:29<00:00,  8.81it/s, loss=1.66]
[Epoch 107]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.64it/s, loss=1.56]
[Epoch 108]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:34<00:00,  8.40it/s, loss=1.71]
[Epoch 109]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:29<00:00,  8.82it/s, loss=1.67]
[Epoch 110]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:27<00:00,  9.05it/s, loss=1.67]
[Epoch 111]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.64it/s, loss=2.34]
[Epoch 112]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.61it/s, loss=1.64]
[Epoch 113]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:27<00:00,  9.02it/s, loss=1.63]
[Epoch 114]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:34<00:00,  8.41it/s, loss=1.62]
[Epoch 115]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:33<00:00,  8.45it/s, loss=2.05]
[Epoch 116]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:40<00:00,  7.87it/s, loss=1.74]
[Epoch 117]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:33<00:00,  8.48it/s, loss=1.54]
[Epoch 118]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:29<00:00,  8.83it/s, loss=1.65]
[Epoch 119]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.69it/s, loss=1.58]
[Epoch 120]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:29<00:00,  8.85it/s, loss=1.57]
[Epoch 121]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.62it/s, loss=1.68]
[Epoch 122]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:35<00:00,  8.28it/s, loss=1.49]
[Epoch 123]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:37<00:00,  8.13it/s, loss=1.61]
[Epoch 124]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:38<00:00,  8.06it/s, loss=1.65]
[Epoch 125]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:36<00:00,  8.24it/s, loss=1.68]
[Epoch 126]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:40<00:00,  7.88it/s, loss=1.56]
[Epoch 127]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:37<00:00,  8.16it/s, loss=1.57]
[Epoch 128]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:38<00:00,  8.06it/s, loss=1.59]
[Epoch 129]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:36<00:00,  8.17it/s, loss=1.69]
[Epoch 130]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:33<00:00,  8.51it/s, loss=1.62]
[Epoch 131]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:37<00:00,  8.09it/s, loss=1.91]
[Epoch 132]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:38<00:00,  8.01it/s, loss=1.61]
[Epoch 133]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:44<00:00,  7.59it/s, loss=1.66]
[Epoch 134]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:37<00:00,  8.10it/s, loss=1.6]
[Epoch 135]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:41<00:00,  7.83it/s, loss=1.55]
[Epoch 136]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:35<00:00,  8.30it/s, loss=1.89]
[Epoch 137]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:36<00:00,  8.17it/s, loss=1.88]
[Epoch 138]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:40<00:00,  7.91it/s, loss=1.66]
[Epoch 139]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:35<00:00,  8.26it/s, loss=1.52]
[Epoch 140]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:38<00:00,  8.02it/s, loss=1.83]
[Epoch 141]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:41<00:00,  7.80it/s, loss=1.66]
[Epoch 142]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:37<00:00,  8.14it/s, loss=1.81]
[Epoch 143]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.53it/s, loss=1.61]
[Epoch 144]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:37<00:00,  8.13it/s, loss=1.57]
[Epoch 145]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:26<00:00,  9.11it/s, loss=1.62]
[Epoch 146]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.77it/s, loss=1.61]
[Epoch 147]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.77it/s, loss=1.61]
[Epoch 148]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.71it/s, loss=1.61]
[Epoch 149]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:29<00:00,  8.90it/s, loss=1.57]
[Epoch 150]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:29<00:00,  8.85it/s, loss=1.55]
[Epoch 151]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:28<00:00,  8.92it/s, loss=1.69]
[Epoch 152]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.68it/s, loss=1.84]
[Epoch 153]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:28<00:00,  8.96it/s, loss=1.61]
[Epoch 154]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:28<00:00,  8.95it/s, loss=1.89]
[Epoch 155]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.58it/s, loss=1.67]
[Epoch 156]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:25<00:00,  9.23it/s, loss=1.62]
[Epoch 157]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.62it/s, loss=1.49]
[Epoch 158]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.61it/s, loss=1.7]
[Epoch 159]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:29<00:00,  8.83it/s, loss=1.85]
[Epoch 160]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.69it/s, loss=1.64]
[Epoch 161]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.69it/s, loss=1.67]
[Epoch 162]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.60it/s, loss=1.95]
[Epoch 163]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:28<00:00,  8.95it/s, loss=1.61]
[Epoch 164]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.76it/s, loss=1.87]
[Epoch 165]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:31<00:00,  8.68it/s, loss=1.61]
[Epoch 166]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:28<00:00,  8.99it/s, loss=1.66]
[Epoch 167]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:32<00:00,  8.54it/s, loss=1.58]
[Epoch 168]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:42<00:00,  7.74it/s, loss=1.67]
[Epoch 169]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:43<00:00,  7.63it/s, loss=1.7]
[Epoch 170]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:40<00:00,  7.85it/s, loss=1.41]
[Epoch 171]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:38<00:00,  8.02it/s, loss=1.65]
[Epoch 172]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.77it/s, loss=1.66]
[Epoch 173]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:41<00:00,  7.80it/s, loss=1.59]
[Epoch 174]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:39<00:00,  7.95it/s, loss=1.64]
[Epoch 175]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:42<00:00,  7.74it/s, loss=1.91]
[Epoch 176]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:34<00:00,  8.36it/s, loss=1.62]
[Epoch 177]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:38<00:00,  8.04it/s, loss=1.5]
[Epoch 178]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:39<00:00,  7.94it/s, loss=1.7]
[Epoch 179]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:38<00:00,  8.03it/s, loss=1.74]
[Epoch 180]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:36<00:00,  8.19it/s, loss=1.62]
[Epoch 181]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:37<00:00,  8.14it/s, loss=1.64]
[Epoch 182]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:40<00:00,  7.91it/s, loss=1.47]
[Epoch 183]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:41<00:00,  7.84it/s, loss=1.54]
[Epoch 184]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:38<00:00,  8.03it/s, loss=1.56]
[Epoch 185]: 100%|██████████████████████████████████████████████████████████████████| 792/792 [01:44<00:00,  7.58it/s, loss=1.6]
[Epoch 186]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:45<00:00,  7.54it/s, loss=1.96]
[Epoch 187]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:47<00:00,  7.36it/s, loss=1.84]
[Epoch 188]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:46<00:00,  7.41it/s, loss=1.66]
[Epoch 189]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:39<00:00,  7.95it/s, loss=1.59]
[Epoch 190]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:37<00:00,  8.11it/s, loss=1.96]
[Epoch 191]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:30<00:00,  8.71it/s, loss=1.77]
[Epoch 192]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:42<00:00,  7.76it/s, loss=1.91]
[Epoch 193]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:40<00:00,  7.89it/s, loss=1.63]
[Epoch 194]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:42<00:00,  7.71it/s, loss=1.54]
[Epoch 195]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:35<00:00,  8.32it/s, loss=1.57]
[Epoch 196]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:39<00:00,  7.94it/s, loss=1.66]
[Epoch 197]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:40<00:00,  7.87it/s, loss=1.66]
[Epoch 198]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:41<00:00,  7.81it/s, loss=2.18]
[Epoch 199]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:42<00:00,  7.74it/s, loss=1.64]
[Epoch 200]: 100%|█████████████████████████████████████████████████████████████████| 792/792 [01:37<00:00,  8.16it/s, loss=1.54]
2021-03-09 17:26:49.096966, 0 ok, hit = 8
2021-03-09 18:14:10.287272, 2000 ok, hit = 4782
2021-03-09 18:51:14.895954, 4000 ok, hit = 8107
2021-03-09 19:26:04.811403, 6000 ok, hit = 11006
2021-03-09 20:00:33.540818, 8000 ok, hit = 13953
2021-03-09 20:41:21.846310, 10000 ok, hit = 16845
2021-03-09 21:42:38.925577, 12000 ok, hit = 19265
2021-03-09 22:23:27.106182, 14000 ok, hit = 21846
2021-03-09 22:51:15.614260, 16000 ok, hit = 24520
2021-03-09 23:19:01.815057, 18000 ok, hit = 27189
2021-03-09 23:46:49.261037, 20000 ok, hit = 29649
2021-03-10 00:14:37.732261, 22000 ok, hit = 31982
2021-03-10 00:42:26.631626, 24000 ok, hit = 34317
2021-03-10 01:10:16.058192, 26000 ok, hit = 36417
2021-03-10 01:38:07.301082, 28000 ok, hit = 38402
HR@20 = 0.4743117422466341, Recall@20 = 0.13258985669809256, NDCG@20 = 0.10572834475148526, HR@50 = 0.6187621407997856, Recall@50 = 0.2157838327446926, NDCG@50 = 0.1320228392281118
```



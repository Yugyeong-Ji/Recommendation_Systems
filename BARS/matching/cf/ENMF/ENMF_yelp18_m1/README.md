## ENMF_yelp18_x0 

A notebook to benchmark ENMF on yelp18_x0 dataset.

Author: Jinpeng Wang, Tsinghua University

Edited by [XUEPAI Team](https://github.com/xue-pai)


### Index
[Environments](#Environments) | [Dataset](#Dataset) | [Code](#Code) | [Results](#Results) | [Logs](#Logs) 

### Environments
+ Hardware

    ```python
    CPU: Intel(R) Xeon(R) CPU E5-2690 v4 @ 2.6GHz
    RAM: 500G+
    GPU: Tesla P100, 16G memory
    ```
+ Software

    ```python
    python: 3.6.5
    tensorflow: 1.14.0
    pandas: 1.0.0
    numpy: 1.18.1
    ```

### Dataset
yelp18_x0 follows the data split and preprocessing steps in NGCF and LightGCN. We directly transform the formats of the data from their [repo](https://github.com/kuandeng/LightGCN/tree/master/Data).


### Code

The details of the code are described [here](./README.md).

1. Downalod the dataset from LightGCN repo and run the preprocessing script for format transformation.

    ```python
    cd data/Yelp18/yelp18_x0
    python ENMF_data_process.py
    cd benchmarks/ENMF
    ```

2. Run the following script to reproduce the result.

    ```python
    # Hyper-parameters:
    dataset = "yelp18_x0"
    train_data = "../../data/Yelp18/yelp18_x0/train_enmf.txt"
    test_data = "../../data/Yelp18/yelp18_x0/test_enmf.txt"
    max_epochs = 500
    batch_size = 256
    embed_size = 64
    lr = 0.05
    dropout = 0.7 # dropout keep_prob
    negative_weight = 0.05 # weight of non-observed data, tuned among [0.001,0.005,0.01,0.02,0.05,0.1,0.2,0.5]
    verbose = 1 # Evaluation interval
    topK = "20 50" # Metrics at TopK
    ```

    ```python
    python -u ENMF.py --gpu 0 --dataset yelp18_x0 --train_data ../../data/Yelp18/yelp18_x0/train_enmf.txt --test_data ../../data/Yelp18/yelp18_x0/test_enmf.txt --verbose 10 --batch_size 256 --epochs 500 --embed_size 64 --lr 0.05 --dropout 0.7 --negative_weight 0.05 --topK 20 50
    ```

### Results
```python
2020-11-06 02:13:21.279928 evaluate at epoch 161
2020-11-06 02:14:03.422394 hitrate@20=0.3848, recall@20=0.0624, ndcg@20=0.0515
2020-11-06 02:14:03.422488 hitrate@50=0.5792, recall@50=0.1189, ndcg@50=0.0723
```

### Logs

```python
tensorflow version: 1.14.0
2020-11-06 01:10:03.858364 loading data ../../data/Yelp18/yelp18_x0/train_enmf.txt
2020-11-06 01:10:04.043809 loading data ../../data/Yelp18/yelp18_x0/test_enmf.txt
2020-11-06 01:10:04.098925 finish loading
2020-11-06 01:10:04.636830 #users=31668, #items=38048
2020-11-06 01:10:06.083131 maximum number of items per user is 1848
2020-11-06 01:10:25.608611 begin to construct the graph

2020-11-06 01:10:32.911874 run epoch 1:  time=20.23s
2020-11-06 01:10:53.146507 loss=0.0735, loss_no_reg=0.0735, loss_reg=0.0000

2020-11-06 01:10:53.146560 evaluate at epoch 1
2020-11-06 01:11:32.996583 hitrate@20=0.0525, recall@20=0.0053, ndcg@20=0.0046
2020-11-06 01:11:32.996661 hitrate@50=0.1015, recall@50=0.0109, ndcg@50=0.0067

2020-11-06 01:11:32.998011 run epoch 2:  time=19.19s
2020-11-06 01:11:52.183248 loss=-898.5049, loss_no_reg=-898.5049, loss_reg=0.0000

2020-11-06 01:11:52.183299 run epoch 3:  time=19.44s
2020-11-06 01:12:11.621888 loss=-1941.0731, loss_no_reg=-1941.0731, loss_reg=0.0000

2020-11-06 01:12:11.621940 run epoch 4:  time=19.18s
2020-11-06 01:12:30.800943 loss=-2528.8042, loss_no_reg=-2528.8042, loss_reg=0.0000

2020-11-06 01:12:30.800979 run epoch 5:  time=17.09s
2020-11-06 01:12:47.888117 loss=-2865.9240, loss_no_reg=-2865.9240, loss_reg=0.0000

2020-11-06 01:12:47.888182 run epoch 6:  time=17.40s
2020-11-06 01:13:05.286099 loss=-3066.8913, loss_no_reg=-3066.8913, loss_reg=0.0000

2020-11-06 01:13:05.286167 run epoch 7:  time=18.02s
2020-11-06 01:13:23.301371 loss=-3211.3619, loss_no_reg=-3211.3619, loss_reg=0.0000

2020-11-06 01:13:23.301424 run epoch 8:  time=19.04s
2020-11-06 01:13:42.339070 loss=-3312.8868, loss_no_reg=-3312.8868, loss_reg=0.0000

2020-11-06 01:13:42.339123 run epoch 9:  time=19.11s
2020-11-06 01:14:01.446682 loss=-3397.5044, loss_no_reg=-3397.5044, loss_reg=0.0000

2020-11-06 01:14:01.446753 run epoch 10:  time=18.11s
2020-11-06 01:14:19.556343 loss=-3457.2107, loss_no_reg=-3457.2107, loss_reg=0.0000

2020-11-06 01:14:19.556394 run epoch 11:  time=18.86s
2020-11-06 01:14:38.412084 loss=-3507.2350, loss_no_reg=-3507.2350, loss_reg=0.0000

2020-11-06 01:14:38.412137 evaluate at epoch 11
2020-11-06 01:15:18.598845 hitrate@20=0.3548, recall@20=0.0561, ndcg@20=0.0463
2020-11-06 01:15:18.598925 hitrate@50=0.5400, recall@50=0.1073, ndcg@50=0.0653

2020-11-06 01:15:18.599502 run epoch 12:  time=18.88s
2020-11-06 01:15:37.481696 loss=-3551.0852, loss_no_reg=-3551.0852, loss_reg=0.0000

2020-11-06 01:15:37.481796 run epoch 13:  time=17.84s
2020-11-06 01:15:55.319616 loss=-3579.4704, loss_no_reg=-3579.4704, loss_reg=0.0000

2020-11-06 01:15:55.319667 run epoch 14:  time=17.03s
2020-11-06 01:16:12.351225 loss=-3604.1561, loss_no_reg=-3604.1561, loss_reg=0.0000

2020-11-06 01:16:12.351277 run epoch 15:  time=18.12s
2020-11-06 01:16:30.473786 loss=-3637.6734, loss_no_reg=-3637.6734, loss_reg=0.0000

2020-11-06 01:16:30.473843 run epoch 16:  time=18.83s
2020-11-06 01:16:49.299809 loss=-3654.5187, loss_no_reg=-3654.5187, loss_reg=0.0000

2020-11-06 01:16:49.299923 run epoch 17:  time=19.12s
2020-11-06 01:17:08.415968 loss=-3675.4699, loss_no_reg=-3675.4699, loss_reg=0.0000

2020-11-06 01:17:08.416024 run epoch 18:  time=18.78s
2020-11-06 01:17:27.199037 loss=-3696.8861, loss_no_reg=-3696.8861, loss_reg=0.0000

2020-11-06 01:17:27.199092 run epoch 19:  time=18.47s
2020-11-06 01:17:45.674187 loss=-3710.4470, loss_no_reg=-3710.4470, loss_reg=0.0000

2020-11-06 01:17:45.674258 run epoch 20:  time=17.21s
2020-11-06 01:18:02.885103 loss=-3716.1129, loss_no_reg=-3716.1129, loss_reg=0.0000

2020-11-06 01:18:02.885165 run epoch 21:  time=18.86s
2020-11-06 01:18:21.746545 loss=-3732.7111, loss_no_reg=-3732.7111, loss_reg=0.0000

2020-11-06 01:18:21.746603 evaluate at epoch 21
2020-11-06 01:19:03.267573 hitrate@20=0.3699, recall@20=0.0589, ndcg@20=0.0487
2020-11-06 01:19:03.267654 hitrate@50=0.5604, recall@50=0.1136, ndcg@50=0.0689

2020-11-06 01:19:03.267727 run epoch 22:  time=20.01s
2020-11-06 01:19:23.278725 loss=-3745.4484, loss_no_reg=-3745.4484, loss_reg=0.0000

2020-11-06 01:19:23.278778 run epoch 23:  time=19.55s
2020-11-06 01:19:42.830892 loss=-3758.8717, loss_no_reg=-3758.8717, loss_reg=0.0000

2020-11-06 01:19:42.830967 run epoch 24:  time=20.60s
2020-11-06 01:20:03.428800 loss=-3763.2715, loss_no_reg=-3763.2715, loss_reg=0.0000

2020-11-06 01:20:03.428855 run epoch 25:  time=20.83s
2020-11-06 01:20:24.261299 loss=-3774.8367, loss_no_reg=-3774.8367, loss_reg=0.0000

2020-11-06 01:20:24.261375 run epoch 26:  time=21.05s
2020-11-06 01:20:45.316089 loss=-3781.4566, loss_no_reg=-3781.4566, loss_reg=0.0000

2020-11-06 01:20:45.316150 run epoch 27:  time=20.82s
2020-11-06 01:21:06.135733 loss=-3796.8860, loss_no_reg=-3796.8860, loss_reg=0.0000

2020-11-06 01:21:06.135787 run epoch 28:  time=17.74s
2020-11-06 01:21:23.875340 loss=-3794.9790, loss_no_reg=-3794.9790, loss_reg=0.0000

2020-11-06 01:21:23.875395 run epoch 29:  time=19.09s
2020-11-06 01:21:42.963777 loss=-3805.6308, loss_no_reg=-3805.6308, loss_reg=0.0000

2020-11-06 01:21:42.963876 run epoch 30:  time=19.21s
2020-11-06 01:22:02.170343 loss=-3802.8461, loss_no_reg=-3802.8461, loss_reg=0.0000

2020-11-06 01:22:02.170450 run epoch 31:  time=19.29s
2020-11-06 01:22:21.458288 loss=-3813.8121, loss_no_reg=-3813.8121, loss_reg=0.0000

2020-11-06 01:22:21.458339 evaluate at epoch 31
2020-11-06 01:23:01.832696 hitrate@20=0.3759, recall@20=0.0603, ndcg@20=0.0499
2020-11-06 01:23:01.832780 hitrate@50=0.5682, recall@50=0.1156, ndcg@50=0.0703

2020-11-06 01:23:01.832863 run epoch 32:  time=20.70s
2020-11-06 01:23:22.534767 loss=-3822.2380, loss_no_reg=-3822.2380, loss_reg=0.0000

2020-11-06 01:23:22.534820 run epoch 33:  time=21.41s
2020-11-06 01:23:43.948103 loss=-3827.3480, loss_no_reg=-3827.3480, loss_reg=0.0000

2020-11-06 01:23:43.948164 run epoch 34:  time=21.44s
2020-11-06 01:24:05.389840 loss=-3825.1137, loss_no_reg=-3825.1137, loss_reg=0.0000

2020-11-06 01:24:05.389893 run epoch 35:  time=19.49s
2020-11-06 01:24:24.880750 loss=-3825.8051, loss_no_reg=-3825.8051, loss_reg=0.0000

2020-11-06 01:24:24.880803 run epoch 36:  time=18.04s
2020-11-06 01:24:42.923813 loss=-3828.9531, loss_no_reg=-3828.9531, loss_reg=0.0000

2020-11-06 01:24:42.923865 run epoch 37:  time=18.12s
2020-11-06 01:25:01.039093 loss=-3837.5774, loss_no_reg=-3837.5774, loss_reg=0.0000

2020-11-06 01:25:01.039152 run epoch 38:  time=19.43s
2020-11-06 01:25:20.473763 loss=-3836.8124, loss_no_reg=-3836.8124, loss_reg=0.0000

2020-11-06 01:25:20.473820 run epoch 39:  time=19.39s
2020-11-06 01:25:39.863658 loss=-3845.2181, loss_no_reg=-3845.2181, loss_reg=0.0000

2020-11-06 01:25:39.863710 run epoch 40:  time=19.32s
2020-11-06 01:25:59.185797 loss=-3850.5097, loss_no_reg=-3850.5097, loss_reg=0.0000

2020-11-06 01:25:59.185850 run epoch 41:  time=18.53s
2020-11-06 01:26:17.714953 loss=-3848.1647, loss_no_reg=-3848.1647, loss_reg=0.0000

2020-11-06 01:26:17.715004 evaluate at epoch 41
2020-11-06 01:26:55.987880 hitrate@20=0.3792, recall@20=0.0611, ndcg@20=0.0504
2020-11-06 01:26:55.987969 hitrate@50=0.5712, recall@50=0.1166, ndcg@50=0.0710

2020-11-06 01:26:55.988030 run epoch 42:  time=19.04s
2020-11-06 01:27:15.024194 loss=-3853.7436, loss_no_reg=-3853.7436, loss_reg=0.0000

2020-11-06 01:27:15.024253 run epoch 43:  time=18.95s
2020-11-06 01:27:33.975681 loss=-3860.0046, loss_no_reg=-3860.0046, loss_reg=0.0000

2020-11-06 01:27:33.975735 run epoch 44:  time=17.67s
2020-11-06 01:27:51.646180 loss=-3853.8823, loss_no_reg=-3853.8823, loss_reg=0.0000

2020-11-06 01:27:51.646240 run epoch 45:  time=18.57s
2020-11-06 01:28:10.217438 loss=-3861.9536, loss_no_reg=-3861.9536, loss_reg=0.0000

2020-11-06 01:28:10.217560 run epoch 46:  time=19.10s
2020-11-06 01:28:29.316498 loss=-3866.8606, loss_no_reg=-3866.8606, loss_reg=0.0000

2020-11-06 01:28:29.316551 run epoch 47:  time=19.15s
2020-11-06 01:28:48.467402 loss=-3866.6386, loss_no_reg=-3866.6386, loss_reg=0.0000

2020-11-06 01:28:48.467456 run epoch 48:  time=19.11s
2020-11-06 01:29:07.579172 loss=-3867.1370, loss_no_reg=-3867.1370, loss_reg=0.0000

2020-11-06 01:29:07.579245 run epoch 49:  time=18.02s
2020-11-06 01:29:25.601315 loss=-3870.4314, loss_no_reg=-3870.4314, loss_reg=0.0000

2020-11-06 01:29:25.601368 run epoch 50:  time=16.94s
2020-11-06 01:29:42.545336 loss=-3870.7762, loss_no_reg=-3870.7762, loss_reg=0.0000

2020-11-06 01:29:42.545391 run epoch 51:  time=17.67s
2020-11-06 01:30:00.210694 loss=-3878.9978, loss_no_reg=-3878.9978, loss_reg=0.0000

2020-11-06 01:30:00.210767 evaluate at epoch 51
2020-11-06 01:30:41.964048 hitrate@20=0.3792, recall@20=0.0612, ndcg@20=0.0507
2020-11-06 01:30:41.964133 hitrate@50=0.5744, recall@50=0.1175, ndcg@50=0.0715

2020-11-06 01:30:41.964207 run epoch 52:  time=18.06s
2020-11-06 01:31:00.026975 loss=-3877.8290, loss_no_reg=-3877.8290, loss_reg=0.0000

2020-11-06 01:31:00.027068 run epoch 53:  time=17.43s
2020-11-06 01:31:17.455640 loss=-3877.2530, loss_no_reg=-3877.2530, loss_reg=0.0000

2020-11-06 01:31:17.455692 run epoch 54:  time=17.71s
2020-11-06 01:31:35.164550 loss=-3884.0111, loss_no_reg=-3884.0111, loss_reg=0.0000

2020-11-06 01:31:35.164604 run epoch 55:  time=19.19s
2020-11-06 01:31:54.359251 loss=-3869.6625, loss_no_reg=-3869.6625, loss_reg=0.0000

2020-11-06 01:31:54.359305 run epoch 56:  time=19.42s
2020-11-06 01:32:13.777409 loss=-3881.3052, loss_no_reg=-3881.3052, loss_reg=0.0000

2020-11-06 01:32:13.777461 run epoch 57:  time=19.85s
2020-11-06 01:32:33.623340 loss=-3886.4234, loss_no_reg=-3886.4234, loss_reg=0.0000

2020-11-06 01:32:33.623390 run epoch 58:  time=19.21s
2020-11-06 01:32:52.837912 loss=-3889.5455, loss_no_reg=-3889.5455, loss_reg=0.0000

2020-11-06 01:32:52.837961 run epoch 59:  time=18.67s
2020-11-06 01:33:11.509265 loss=-3882.4996, loss_no_reg=-3882.4996, loss_reg=0.0000

2020-11-06 01:33:11.509316 run epoch 60:  time=19.47s
2020-11-06 01:33:30.981303 loss=-3879.6305, loss_no_reg=-3879.6305, loss_reg=0.0000

2020-11-06 01:33:30.981377 run epoch 61:  time=19.44s
2020-11-06 01:33:50.425187 loss=-3897.3842, loss_no_reg=-3897.3842, loss_reg=0.0000

2020-11-06 01:33:50.425238 evaluate at epoch 61
2020-11-06 01:34:30.317089 hitrate@20=0.3821, recall@20=0.0618, ndcg@20=0.0511
2020-11-06 01:34:30.317182 hitrate@50=0.5752, recall@50=0.1179, ndcg@50=0.0718

2020-11-06 01:34:30.317274 run epoch 62:  time=18.96s
2020-11-06 01:34:49.276215 loss=-3891.0385, loss_no_reg=-3891.0385, loss_reg=0.0000

2020-11-06 01:34:49.276292 run epoch 63:  time=19.50s
2020-11-06 01:35:08.772751 loss=-3891.2871, loss_no_reg=-3891.2871, loss_reg=0.0000

2020-11-06 01:35:08.772804 run epoch 64:  time=19.84s
2020-11-06 01:35:28.616920 loss=-3896.8130, loss_no_reg=-3896.8130, loss_reg=0.0000

2020-11-06 01:35:28.616974 run epoch 65:  time=21.59s
2020-11-06 01:35:50.203276 loss=-3895.9314, loss_no_reg=-3895.9314, loss_reg=0.0000

2020-11-06 01:35:50.203362 run epoch 66:  time=18.76s
2020-11-06 01:36:08.963883 loss=-3897.2809, loss_no_reg=-3897.2809, loss_reg=0.0000

2020-11-06 01:36:08.963941 run epoch 67:  time=19.41s
2020-11-06 01:36:28.369121 loss=-3898.8785, loss_no_reg=-3898.8785, loss_reg=0.0000

2020-11-06 01:36:28.369183 run epoch 68:  time=20.15s
2020-11-06 01:36:48.524221 loss=-3901.6997, loss_no_reg=-3901.6997, loss_reg=0.0000

2020-11-06 01:36:48.524281 run epoch 69:  time=20.20s
2020-11-06 01:37:08.722379 loss=-3896.3157, loss_no_reg=-3896.3157, loss_reg=0.0000

2020-11-06 01:37:08.722432 run epoch 70:  time=20.09s
2020-11-06 01:37:28.810798 loss=-3892.9810, loss_no_reg=-3892.9810, loss_reg=0.0000

2020-11-06 01:37:28.810858 run epoch 71:  time=18.52s
2020-11-06 01:37:47.331343 loss=-3907.9372, loss_no_reg=-3907.9372, loss_reg=0.0000

2020-11-06 01:37:47.331402 evaluate at epoch 71
2020-11-06 01:38:27.768694 hitrate@20=0.3818, recall@20=0.0618, ndcg@20=0.0511
2020-11-06 01:38:27.768770 hitrate@50=0.5764, recall@50=0.1182, ndcg@50=0.0719
2020-11-06 01:38:27.768809 the monitor counts down its patience to 4!

2020-11-06 01:38:27.768841 run epoch 72:  time=19.21s
2020-11-06 01:38:46.979894 loss=-3904.1215, loss_no_reg=-3904.1215, loss_reg=0.0000

2020-11-06 01:38:46.979950 run epoch 73:  time=19.37s
2020-11-06 01:39:06.354774 loss=-3901.9164, loss_no_reg=-3901.9164, loss_reg=0.0000

2020-11-06 01:39:06.354825 run epoch 74:  time=18.88s
2020-11-06 01:39:25.239184 loss=-3904.4359, loss_no_reg=-3904.4359, loss_reg=0.0000

2020-11-06 01:39:25.239263 run epoch 75:  time=20.03s
2020-11-06 01:39:45.269349 loss=-3907.8066, loss_no_reg=-3907.8066, loss_reg=0.0000

2020-11-06 01:39:45.269445 run epoch 76:  time=19.28s
2020-11-06 01:40:04.550447 loss=-3912.6603, loss_no_reg=-3912.6603, loss_reg=0.0000

2020-11-06 01:40:04.550523 run epoch 77:  time=19.94s
2020-11-06 01:40:24.486847 loss=-3907.3799, loss_no_reg=-3907.3799, loss_reg=0.0000

2020-11-06 01:40:24.486903 run epoch 78:  time=20.07s
2020-11-06 01:40:44.557676 loss=-3907.7914, loss_no_reg=-3907.7914, loss_reg=0.0000

2020-11-06 01:40:44.557739 run epoch 79:  time=18.37s
2020-11-06 01:41:02.925778 loss=-3917.2958, loss_no_reg=-3917.2958, loss_reg=0.0000

2020-11-06 01:41:02.925845 run epoch 80:  time=20.11s
2020-11-06 01:41:23.032512 loss=-3911.5109, loss_no_reg=-3911.5109, loss_reg=0.0000

2020-11-06 01:41:23.032564 run epoch 81:  time=20.10s
2020-11-06 01:41:43.132183 loss=-3913.4931, loss_no_reg=-3913.4931, loss_reg=0.0000

2020-11-06 01:41:43.132253 evaluate at epoch 81
2020-11-06 01:42:26.030523 hitrate@20=0.3817, recall@20=0.0618, ndcg@20=0.0512
2020-11-06 01:42:26.030605 hitrate@50=0.5780, recall@50=0.1185, ndcg@50=0.0721

2020-11-06 01:42:26.030670 run epoch 82:  time=18.33s
2020-11-06 01:42:44.358082 loss=-3915.6778, loss_no_reg=-3915.6778, loss_reg=0.0000

2020-11-06 01:42:44.358140 run epoch 83:  time=20.86s
2020-11-06 01:43:05.215582 loss=-3913.7746, loss_no_reg=-3913.7746, loss_reg=0.0000

2020-11-06 01:43:05.215638 run epoch 84:  time=19.80s
2020-11-06 01:43:25.014257 loss=-3912.4040, loss_no_reg=-3912.4040, loss_reg=0.0000

2020-11-06 01:43:25.014310 run epoch 85:  time=19.18s
2020-11-06 01:43:44.198166 loss=-3921.0794, loss_no_reg=-3921.0794, loss_reg=0.0000

2020-11-06 01:43:44.198222 run epoch 86:  time=18.45s
2020-11-06 01:44:02.650803 loss=-3914.8863, loss_no_reg=-3914.8863, loss_reg=0.0000

2020-11-06 01:44:02.650856 run epoch 87:  time=18.68s
2020-11-06 01:44:21.327724 loss=-3914.2171, loss_no_reg=-3914.2171, loss_reg=0.0000

2020-11-06 01:44:21.327780 run epoch 88:  time=19.11s
2020-11-06 01:44:40.442777 loss=-3920.1960, loss_no_reg=-3920.1960, loss_reg=0.0000

2020-11-06 01:44:40.442814 run epoch 89:  time=19.40s
2020-11-06 01:44:59.838402 loss=-3919.6771, loss_no_reg=-3919.6771, loss_reg=0.0000

2020-11-06 01:44:59.838474 run epoch 90:  time=19.78s
2020-11-06 01:45:19.617589 loss=-3918.6938, loss_no_reg=-3918.6938, loss_reg=0.0000

2020-11-06 01:45:19.617640 run epoch 91:  time=19.34s
2020-11-06 01:45:38.954184 loss=-3921.1913, loss_no_reg=-3921.1913, loss_reg=0.0000

2020-11-06 01:45:38.954238 evaluate at epoch 91
2020-11-06 01:46:17.774280 hitrate@20=0.3816, recall@20=0.0619, ndcg@20=0.0512
2020-11-06 01:46:17.774367 hitrate@50=0.5786, recall@50=0.1186, ndcg@50=0.0721

2020-11-06 01:46:17.774465 run epoch 92:  time=20.24s
2020-11-06 01:46:38.017563 loss=-3916.8760, loss_no_reg=-3916.8760, loss_reg=0.0000

2020-11-06 01:46:38.017615 run epoch 93:  time=20.23s
2020-11-06 01:46:58.247036 loss=-3925.5869, loss_no_reg=-3925.5869, loss_reg=0.0000

2020-11-06 01:46:58.247076 run epoch 94:  time=18.78s
2020-11-06 01:47:17.029841 loss=-3920.8978, loss_no_reg=-3920.8978, loss_reg=0.0000

2020-11-06 01:47:17.029907 run epoch 95:  time=17.95s
2020-11-06 01:47:34.981819 loss=-3921.2905, loss_no_reg=-3921.2905, loss_reg=0.0000

2020-11-06 01:47:34.981876 run epoch 96:  time=17.42s
2020-11-06 01:47:52.397581 loss=-3922.2150, loss_no_reg=-3922.2150, loss_reg=0.0000

2020-11-06 01:47:52.397631 run epoch 97:  time=19.20s
2020-11-06 01:48:11.596980 loss=-3921.2242, loss_no_reg=-3921.2242, loss_reg=0.0000

2020-11-06 01:48:11.597031 run epoch 98:  time=19.50s
2020-11-06 01:48:31.095309 loss=-3924.6065, loss_no_reg=-3924.6065, loss_reg=0.0000

2020-11-06 01:48:31.095376 run epoch 99:  time=19.44s
2020-11-06 01:48:50.540303 loss=-3917.8682, loss_no_reg=-3917.8682, loss_reg=0.0000

2020-11-06 01:48:50.540391 run epoch 100:  time=18.99s
2020-11-06 01:49:09.529568 loss=-3926.1974, loss_no_reg=-3926.1974, loss_reg=0.0000

2020-11-06 01:49:09.529643 run epoch 101:  time=17.42s
2020-11-06 01:49:26.946221 loss=-3927.5420, loss_no_reg=-3927.5420, loss_reg=0.0000

2020-11-06 01:49:26.946295 evaluate at epoch 101
2020-11-06 01:50:08.553897 hitrate@20=0.3837, recall@20=0.0622, ndcg@20=0.0513
2020-11-06 01:50:08.553981 hitrate@50=0.5794, recall@50=0.1189, ndcg@50=0.0723

2020-11-06 01:50:08.554046 run epoch 102:  time=19.89s
2020-11-06 01:50:28.442756 loss=-3926.9928, loss_no_reg=-3926.9928, loss_reg=0.0000

2020-11-06 01:50:28.442846 run epoch 103:  time=19.99s
2020-11-06 01:50:48.436724 loss=-3927.1615, loss_no_reg=-3927.1615, loss_reg=0.0000

2020-11-06 01:50:48.436777 run epoch 104:  time=17.78s
2020-11-06 01:51:06.218837 loss=-3921.3206, loss_no_reg=-3921.3206, loss_reg=0.0000

2020-11-06 01:51:06.218890 run epoch 105:  time=20.11s
2020-11-06 01:51:26.325496 loss=-3922.3614, loss_no_reg=-3922.3614, loss_reg=0.0000

2020-11-06 01:51:26.325547 run epoch 106:  time=20.44s
2020-11-06 01:51:46.764950 loss=-3921.1021, loss_no_reg=-3921.1021, loss_reg=0.0000

2020-11-06 01:51:46.765001 run epoch 107:  time=19.98s
2020-11-06 01:52:06.742655 loss=-3924.5332, loss_no_reg=-3924.5332, loss_reg=0.0000

2020-11-06 01:52:06.742715 run epoch 108:  time=20.33s
2020-11-06 01:52:27.073537 loss=-3930.0868, loss_no_reg=-3930.0868, loss_reg=0.0000

2020-11-06 01:52:27.073598 run epoch 109:  time=17.75s
2020-11-06 01:52:44.823679 loss=-3930.3869, loss_no_reg=-3930.3869, loss_reg=0.0000

2020-11-06 01:52:44.823729 run epoch 110:  time=19.42s
2020-11-06 01:53:04.244390 loss=-3929.7173, loss_no_reg=-3929.7173, loss_reg=0.0000

2020-11-06 01:53:04.244461 run epoch 111:  time=20.36s
2020-11-06 01:53:24.605500 loss=-3930.0465, loss_no_reg=-3930.0465, loss_reg=0.0000

2020-11-06 01:53:24.605556 evaluate at epoch 111
2020-11-06 01:54:05.445576 hitrate@20=0.3824, recall@20=0.0620, ndcg@20=0.0512
2020-11-06 01:54:05.445657 hitrate@50=0.5792, recall@50=0.1187, ndcg@50=0.0722
2020-11-06 01:54:05.445692 the monitor counts down its patience to 4!

2020-11-06 01:54:05.445729 run epoch 112:  time=18.37s
2020-11-06 01:54:23.812475 loss=-3928.7877, loss_no_reg=-3928.7877, loss_reg=0.0000

2020-11-06 01:54:23.812524 run epoch 113:  time=19.30s
2020-11-06 01:54:43.107904 loss=-3934.8778, loss_no_reg=-3934.8778, loss_reg=0.0000

2020-11-06 01:54:43.107979 run epoch 114:  time=19.95s
2020-11-06 01:55:03.055340 loss=-3938.1812, loss_no_reg=-3938.1812, loss_reg=0.0000

2020-11-06 01:55:03.055389 run epoch 115:  time=20.11s
2020-11-06 01:55:23.169587 loss=-3926.7488, loss_no_reg=-3926.7488, loss_reg=0.0000

2020-11-06 01:55:23.169636 run epoch 116:  time=19.62s
2020-11-06 01:55:42.791014 loss=-3932.2140, loss_no_reg=-3932.2140, loss_reg=0.0000

2020-11-06 01:55:42.791064 run epoch 117:  time=18.55s
2020-11-06 01:56:01.340269 loss=-3936.0857, loss_no_reg=-3936.0857, loss_reg=0.0000

2020-11-06 01:56:01.340321 run epoch 118:  time=19.64s
2020-11-06 01:56:20.976215 loss=-3936.5883, loss_no_reg=-3936.5883, loss_reg=0.0000

2020-11-06 01:56:20.976264 run epoch 119:  time=20.20s
2020-11-06 01:56:41.171913 loss=-3930.8522, loss_no_reg=-3930.8522, loss_reg=0.0000

2020-11-06 01:56:41.171983 run epoch 120:  time=25.69s
2020-11-06 01:57:06.858898 loss=-3934.2267, loss_no_reg=-3934.2267, loss_reg=0.0000

2020-11-06 01:57:06.858995 run epoch 121:  time=22.19s
2020-11-06 01:57:29.053004 loss=-3928.9672, loss_no_reg=-3928.9672, loss_reg=0.0000

2020-11-06 01:57:29.053065 evaluate at epoch 121
2020-11-06 01:58:12.455525 hitrate@20=0.3833, recall@20=0.0621, ndcg@20=0.0513
2020-11-06 01:58:12.455680 hitrate@50=0.5796, recall@50=0.1189, ndcg@50=0.0723
2020-11-06 01:58:12.455731 the monitor counts down its patience to 3!

2020-11-06 01:58:12.455799 run epoch 122:  time=26.52s
2020-11-06 01:58:38.980836 loss=-3937.5552, loss_no_reg=-3937.5552, loss_reg=0.0000

2020-11-06 01:58:38.980905 run epoch 123:  time=20.56s
2020-11-06 01:58:59.544095 loss=-3933.4668, loss_no_reg=-3933.4668, loss_reg=0.0000

2020-11-06 01:58:59.544211 run epoch 124:  time=19.56s
2020-11-06 01:59:19.103380 loss=-3931.9666, loss_no_reg=-3931.9666, loss_reg=0.0000

2020-11-06 01:59:19.103448 run epoch 125:  time=18.12s
2020-11-06 01:59:37.222113 loss=-3936.2427, loss_no_reg=-3936.2427, loss_reg=0.0000

2020-11-06 01:59:37.222855 run epoch 126:  time=19.16s
2020-11-06 01:59:56.385028 loss=-3937.4689, loss_no_reg=-3937.4689, loss_reg=0.0000

2020-11-06 01:59:56.385079 run epoch 127:  time=19.38s
2020-11-06 02:00:15.763700 loss=-3935.1296, loss_no_reg=-3935.1296, loss_reg=0.0000

2020-11-06 02:00:15.763748 run epoch 128:  time=20.86s
2020-11-06 02:00:36.622237 loss=-3934.9723, loss_no_reg=-3934.9723, loss_reg=0.0000

2020-11-06 02:00:36.622288 run epoch 129:  time=20.20s
2020-11-06 02:00:56.823108 loss=-3937.5100, loss_no_reg=-3937.5100, loss_reg=0.0000

2020-11-06 02:00:56.823166 run epoch 130:  time=18.11s
2020-11-06 02:01:14.937196 loss=-3932.5591, loss_no_reg=-3932.5591, loss_reg=0.0000

2020-11-06 02:01:14.937244 run epoch 131:  time=20.52s
2020-11-06 02:01:35.461639 loss=-3940.4473, loss_no_reg=-3940.4473, loss_reg=0.0000

2020-11-06 02:01:35.461710 evaluate at epoch 131
2020-11-06 02:02:16.135597 hitrate@20=0.3836, recall@20=0.0621, ndcg@20=0.0513
2020-11-06 02:02:16.135677 hitrate@50=0.5797, recall@50=0.1188, ndcg@50=0.0722
2020-11-06 02:02:16.135728 the monitor counts down its patience to 2!

2020-11-06 02:02:16.135766 run epoch 132:  time=20.49s
2020-11-06 02:02:36.629781 loss=-3935.0488, loss_no_reg=-3935.0488, loss_reg=0.0000

2020-11-06 02:02:36.629833 run epoch 133:  time=17.78s
2020-11-06 02:02:54.414306 loss=-3934.8581, loss_no_reg=-3934.8581, loss_reg=0.0000

2020-11-06 02:02:54.414379 run epoch 134:  time=18.10s
2020-11-06 02:03:12.516421 loss=-3934.4442, loss_no_reg=-3934.4442, loss_reg=0.0000

2020-11-06 02:03:12.516467 run epoch 135:  time=18.18s
2020-11-06 02:03:30.693262 loss=-3938.5316, loss_no_reg=-3938.5316, loss_reg=0.0000

2020-11-06 02:03:30.693329 run epoch 136:  time=19.36s
2020-11-06 02:03:50.058118 loss=-3938.3937, loss_no_reg=-3938.3937, loss_reg=0.0000

2020-11-06 02:03:50.058226 run epoch 137:  time=19.37s
2020-11-06 02:04:09.432464 loss=-3942.3711, loss_no_reg=-3942.3711, loss_reg=0.0000

2020-11-06 02:04:09.432533 run epoch 138:  time=18.41s
2020-11-06 02:04:27.843870 loss=-3935.6562, loss_no_reg=-3935.6562, loss_reg=0.0000

2020-11-06 02:04:27.843917 run epoch 139:  time=19.43s
2020-11-06 02:04:47.273618 loss=-3931.6427, loss_no_reg=-3931.6427, loss_reg=0.0000

2020-11-06 02:04:47.273670 run epoch 140:  time=19.66s
2020-11-06 02:05:06.929499 loss=-3939.5730, loss_no_reg=-3939.5730, loss_reg=0.0000

2020-11-06 02:05:06.929547 run epoch 141:  time=19.72s
2020-11-06 02:05:26.654654 loss=-3941.2910, loss_no_reg=-3941.2910, loss_reg=0.0000

2020-11-06 02:05:26.654706 evaluate at epoch 141
2020-11-06 02:06:06.522030 hitrate@20=0.3834, recall@20=0.0622, ndcg@20=0.0513
2020-11-06 02:06:06.522101 hitrate@50=0.5795, recall@50=0.1190, ndcg@50=0.0723
2020-11-06 02:06:06.522137 the monitor counts down its patience to 1!

2020-11-06 02:06:06.522184 run epoch 142:  time=18.52s
2020-11-06 02:06:25.041668 loss=-3935.2470, loss_no_reg=-3935.2470, loss_reg=0.0000

2020-11-06 02:06:25.041717 run epoch 143:  time=18.79s
2020-11-06 02:06:43.829923 loss=-3943.2632, loss_no_reg=-3943.2632, loss_reg=0.0000

2020-11-06 02:06:43.829968 run epoch 144:  time=20.20s
2020-11-06 02:07:04.029132 loss=-3941.8129, loss_no_reg=-3941.8129, loss_reg=0.0000

2020-11-06 02:07:04.029218 run epoch 145:  time=21.05s
2020-11-06 02:07:25.079843 loss=-3942.6094, loss_no_reg=-3942.6094, loss_reg=0.0000

2020-11-06 02:07:25.080501 run epoch 146:  time=19.65s
2020-11-06 02:07:44.726701 loss=-3940.9574, loss_no_reg=-3940.9574, loss_reg=0.0000

2020-11-06 02:07:44.726756 run epoch 147:  time=18.92s
2020-11-06 02:08:03.645632 loss=-3943.1851, loss_no_reg=-3943.1851, loss_reg=0.0000

2020-11-06 02:08:03.645678 run epoch 148:  time=19.28s
2020-11-06 02:08:22.929267 loss=-3939.8371, loss_no_reg=-3939.8371, loss_reg=0.0000

2020-11-06 02:08:22.929345 run epoch 149:  time=19.94s
2020-11-06 02:08:42.868359 loss=-3939.9300, loss_no_reg=-3939.9300, loss_reg=0.0000

2020-11-06 02:08:42.868422 run epoch 150:  time=19.89s
2020-11-06 02:09:02.762183 loss=-3943.1720, loss_no_reg=-3943.1720, loss_reg=0.0000

2020-11-06 02:09:02.762246 run epoch 151:  time=19.74s
2020-11-06 02:09:22.503931 loss=-3946.2111, loss_no_reg=-3946.2111, loss_reg=0.0000

2020-11-06 02:09:22.503979 evaluate at epoch 151
2020-11-06 02:10:02.980464 hitrate@20=0.3843, recall@20=0.0622, ndcg@20=0.0513
2020-11-06 02:10:02.980666 hitrate@50=0.5797, recall@50=0.1190, ndcg@50=0.0723

2020-11-06 02:10:02.980762 run epoch 152:  time=20.20s
2020-11-06 02:10:23.184816 loss=-3942.9553, loss_no_reg=-3942.9553, loss_reg=0.0000

2020-11-06 02:10:23.184852 run epoch 153:  time=21.25s
2020-11-06 02:10:44.431980 loss=-3938.2749, loss_no_reg=-3938.2749, loss_reg=0.0000

2020-11-06 02:10:44.432026 run epoch 154:  time=19.61s
2020-11-06 02:11:04.041235 loss=-3943.0298, loss_no_reg=-3943.0298, loss_reg=0.0000

2020-11-06 02:11:04.041852 run epoch 155:  time=18.85s
2020-11-06 02:11:22.891429 loss=-3946.1800, loss_no_reg=-3946.1800, loss_reg=0.0000

2020-11-06 02:11:22.891474 run epoch 156:  time=20.16s
2020-11-06 02:11:43.053876 loss=-3944.3482, loss_no_reg=-3944.3482, loss_reg=0.0000

2020-11-06 02:11:43.053924 run epoch 157:  time=21.25s
2020-11-06 02:12:04.301114 loss=-3939.3203, loss_no_reg=-3939.3203, loss_reg=0.0000

2020-11-06 02:12:04.301174 run epoch 158:  time=20.27s
2020-11-06 02:12:24.571988 loss=-3945.1735, loss_no_reg=-3945.1735, loss_reg=0.0000

2020-11-06 02:12:24.572053 run epoch 159:  time=19.17s
2020-11-06 02:12:43.745671 loss=-3939.5102, loss_no_reg=-3939.5102, loss_reg=0.0000

2020-11-06 02:12:43.745716 run epoch 160:  time=18.24s
2020-11-06 02:13:01.983453 loss=-3945.6806, loss_no_reg=-3945.6806, loss_reg=0.0000

2020-11-06 02:13:01.983506 run epoch 161:  time=19.30s
2020-11-06 02:13:21.279220 loss=-3940.9728, loss_no_reg=-3940.9728, loss_reg=0.0000

2020-11-06 02:13:21.279928 evaluate at epoch 161
2020-11-06 02:14:03.422394 hitrate@20=0.3848, recall@20=0.0624, ndcg@20=0.0515
2020-11-06 02:14:03.422488 hitrate@50=0.5792, recall@50=0.1189, ndcg@50=0.0723

2020-11-06 02:14:03.422554 run epoch 162:  time=18.57s
2020-11-06 02:14:21.994308 loss=-3943.8432, loss_no_reg=-3943.8432, loss_reg=0.0000

2020-11-06 02:14:21.994365 run epoch 163:  time=19.36s
2020-11-06 02:14:41.350215 loss=-3949.6050, loss_no_reg=-3949.6050, loss_reg=0.0000

2020-11-06 02:14:41.350285 run epoch 164:  time=19.73s
2020-11-06 02:15:01.078218 loss=-3948.4545, loss_no_reg=-3948.4545, loss_reg=0.0000

2020-11-06 02:15:01.078338 run epoch 165:  time=21.26s
2020-11-06 02:15:22.337924 loss=-3945.1384, loss_no_reg=-3945.1384, loss_reg=0.0000

2020-11-06 02:15:22.337973 run epoch 166:  time=20.18s
2020-11-06 02:15:42.517985 loss=-3946.9398, loss_no_reg=-3946.9398, loss_reg=0.0000

2020-11-06 02:15:42.518031 run epoch 167:  time=18.33s
2020-11-06 02:16:00.850762 loss=-3952.6954, loss_no_reg=-3952.6954, loss_reg=0.0000

2020-11-06 02:16:00.850817 run epoch 168:  time=20.13s
2020-11-06 02:16:20.980821 loss=-3942.0828, loss_no_reg=-3942.0828, loss_reg=0.0000

2020-11-06 02:16:20.981544 run epoch 169:  time=20.31s
2020-11-06 02:16:41.289356 loss=-3942.7467, loss_no_reg=-3942.7467, loss_reg=0.0000

2020-11-06 02:16:41.289407 run epoch 170:  time=20.09s
2020-11-06 02:17:01.375717 loss=-3946.8351, loss_no_reg=-3946.8351, loss_reg=0.0000

2020-11-06 02:17:01.376358 run epoch 171:  time=20.03s
2020-11-06 02:17:21.408796 loss=-3949.1829, loss_no_reg=-3949.1829, loss_reg=0.0000

2020-11-06 02:17:21.408843 evaluate at epoch 171
2020-11-06 02:18:01.855907 hitrate@20=0.3835, recall@20=0.0621, ndcg@20=0.0513
2020-11-06 02:18:01.856009 hitrate@50=0.5804, recall@50=0.1191, ndcg@50=0.0723
2020-11-06 02:18:01.856063 the monitor counts down its patience to 4!

2020-11-06 02:18:01.856124 run epoch 172:  time=19.65s
2020-11-06 02:18:21.506607 loss=-3951.2316, loss_no_reg=-3951.2316, loss_reg=0.0000

2020-11-06 02:18:21.506653 run epoch 173:  time=21.01s
2020-11-06 02:18:42.512406 loss=-3948.9356, loss_no_reg=-3948.9356, loss_reg=0.0000

2020-11-06 02:18:42.512476 run epoch 174:  time=19.05s
2020-11-06 02:19:01.567403 loss=-3947.5641, loss_no_reg=-3947.5641, loss_reg=0.0000

2020-11-06 02:19:01.567458 run epoch 175:  time=19.51s
2020-11-06 02:19:21.073185 loss=-3949.0388, loss_no_reg=-3949.0388, loss_reg=0.0000

2020-11-06 02:19:21.073244 run epoch 176:  time=18.89s
2020-11-06 02:19:39.965845 loss=-3953.1362, loss_no_reg=-3953.1362, loss_reg=0.0000

2020-11-06 02:19:39.966498 run epoch 177:  time=19.69s
2020-11-06 02:19:59.656712 loss=-3947.9827, loss_no_reg=-3947.9827, loss_reg=0.0000

2020-11-06 02:19:59.656767 run epoch 178:  time=20.00s
2020-11-06 02:20:19.656476 loss=-3945.9696, loss_no_reg=-3945.9696, loss_reg=0.0000

2020-11-06 02:20:19.657108 run epoch 179:  time=18.60s
2020-11-06 02:20:38.257086 loss=-3951.8442, loss_no_reg=-3951.8442, loss_reg=0.0000

2020-11-06 02:20:38.257176 run epoch 180:  time=20.52s
2020-11-06 02:20:58.780549 loss=-3948.9740, loss_no_reg=-3948.9740, loss_reg=0.0000

2020-11-06 02:20:58.780606 run epoch 181:  time=19.19s
2020-11-06 02:21:17.972780 loss=-3940.6974, loss_no_reg=-3940.6974, loss_reg=0.0000

2020-11-06 02:21:17.972839 evaluate at epoch 181
2020-11-06 02:21:59.497909 hitrate@20=0.3842, recall@20=0.0623, ndcg@20=0.0513
2020-11-06 02:21:59.498004 hitrate@50=0.5808, recall@50=0.1191, ndcg@50=0.0723
2020-11-06 02:21:59.498043 the monitor counts down its patience to 3!

2020-11-06 02:21:59.498085 run epoch 182:  time=19.78s
2020-11-06 02:22:19.281529 loss=-3952.1969, loss_no_reg=-3952.1969, loss_reg=0.0000

2020-11-06 02:22:19.281601 run epoch 183:  time=17.39s
2020-11-06 02:22:36.670157 loss=-3942.0430, loss_no_reg=-3942.0430, loss_reg=0.0000

2020-11-06 02:22:36.670245 run epoch 184:  time=18.56s
2020-11-06 02:22:55.225857 loss=-3945.7092, loss_no_reg=-3945.7092, loss_reg=0.0000

2020-11-06 02:22:55.225910 run epoch 185:  time=19.22s
2020-11-06 02:23:14.444369 loss=-3945.1686, loss_no_reg=-3945.1686, loss_reg=0.0000

2020-11-06 02:23:14.444421 run epoch 186:  time=19.27s
2020-11-06 02:23:33.712734 loss=-3955.0521, loss_no_reg=-3955.0521, loss_reg=0.0000

2020-11-06 02:23:33.713404 run epoch 187:  time=19.48s
2020-11-06 02:23:53.196352 loss=-3945.5877, loss_no_reg=-3945.5877, loss_reg=0.0000

2020-11-06 02:23:53.196403 run epoch 188:  time=18.23s
2020-11-06 02:24:11.427330 loss=-3952.4787, loss_no_reg=-3952.4787, loss_reg=0.0000

2020-11-06 02:24:11.427380 run epoch 189:  time=19.73s
2020-11-06 02:24:31.160043 loss=-3947.9428, loss_no_reg=-3947.9428, loss_reg=0.0000

2020-11-06 02:24:31.160126 run epoch 190:  time=19.93s
2020-11-06 02:24:51.093864 loss=-3954.2008, loss_no_reg=-3954.2008, loss_reg=0.0000

2020-11-06 02:24:51.093942 run epoch 191:  time=19.91s
2020-11-06 02:25:11.008721 loss=-3948.8028, loss_no_reg=-3948.8028, loss_reg=0.0000

2020-11-06 02:25:11.008773 evaluate at epoch 191
2020-11-06 02:25:51.528107 hitrate@20=0.3839, recall@20=0.0624, ndcg@20=0.0514
2020-11-06 02:25:51.528229 hitrate@50=0.5805, recall@50=0.1192, ndcg@50=0.0724
2020-11-06 02:25:51.528312 the monitor counts down its patience to 2!

2020-11-06 02:25:51.528383 run epoch 192:  time=20.05s
2020-11-06 02:26:11.579281 loss=-3950.5123, loss_no_reg=-3950.5123, loss_reg=0.0000

2020-11-06 02:26:11.579321 run epoch 193:  time=20.44s
2020-11-06 02:26:32.015686 loss=-3952.5968, loss_no_reg=-3952.5968, loss_reg=0.0000

2020-11-06 02:26:32.015737 run epoch 194:  time=20.11s
2020-11-06 02:26:52.124638 loss=-3949.4139, loss_no_reg=-3949.4139, loss_reg=0.0000

2020-11-06 02:26:52.124689 run epoch 195:  time=20.13s
2020-11-06 02:27:12.251608 loss=-3948.9889, loss_no_reg=-3948.9889, loss_reg=0.0000

2020-11-06 02:27:12.251660 run epoch 196:  time=17.96s
2020-11-06 02:27:30.213078 loss=-3948.9036, loss_no_reg=-3948.9036, loss_reg=0.0000

2020-11-06 02:27:30.213163 run epoch 197:  time=19.46s
2020-11-06 02:27:49.669424 loss=-3953.4358, loss_no_reg=-3953.4358, loss_reg=0.0000

2020-11-06 02:27:49.669488 run epoch 198:  time=19.52s
2020-11-06 02:28:09.192964 loss=-3950.9045, loss_no_reg=-3950.9045, loss_reg=0.0000

2020-11-06 02:28:09.193033 run epoch 199:  time=20.49s
2020-11-06 02:28:29.678394 loss=-3955.2633, loss_no_reg=-3955.2633, loss_reg=0.0000

2020-11-06 02:28:29.678465 run epoch 200:  time=19.89s
2020-11-06 02:28:49.563945 loss=-3946.5824, loss_no_reg=-3946.5824, loss_reg=0.0000

2020-11-06 02:28:49.564148 run epoch 201:  time=18.61s
2020-11-06 02:29:08.170882 loss=-3952.7672, loss_no_reg=-3952.7672, loss_reg=0.0000

2020-11-06 02:29:08.171544 evaluate at epoch 201
2020-11-06 02:29:48.071573 hitrate@20=0.3839, recall@20=0.0620, ndcg@20=0.0513
2020-11-06 02:29:48.071658 hitrate@50=0.5803, recall@50=0.1191, ndcg@50=0.0724
2020-11-06 02:29:48.071694 the monitor counts down its patience to 1!

2020-11-06 02:29:48.071748 run epoch 202:  time=20.07s
2020-11-06 02:30:08.143353 loss=-3951.1994, loss_no_reg=-3951.1994, loss_reg=0.0000

2020-11-06 02:30:08.143401 run epoch 203:  time=19.30s
2020-11-06 02:30:27.447759 loss=-3952.2081, loss_no_reg=-3952.2081, loss_reg=0.0000

2020-11-06 02:30:27.448398 run epoch 204:  time=19.09s
2020-11-06 02:30:46.539754 loss=-3950.6011, loss_no_reg=-3950.6011, loss_reg=0.0000

2020-11-06 02:30:46.539803 run epoch 205:  time=19.98s
2020-11-06 02:31:06.518338 loss=-3952.6458, loss_no_reg=-3952.6458, loss_reg=0.0000

2020-11-06 02:31:06.518385 run epoch 206:  time=20.34s
2020-11-06 02:31:26.859951 loss=-3948.7185, loss_no_reg=-3948.7185, loss_reg=0.0000

2020-11-06 02:31:26.859997 run epoch 207:  time=21.04s
2020-11-06 02:31:47.902690 loss=-3947.4890, loss_no_reg=-3947.4890, loss_reg=0.0000

2020-11-06 02:31:47.902746 run epoch 208:  time=19.50s
2020-11-06 02:32:07.401180 loss=-3948.6480, loss_no_reg=-3948.6480, loss_reg=0.0000

2020-11-06 02:32:07.401230 run epoch 209:  time=19.64s
2020-11-06 02:32:27.039810 loss=-3954.6161, loss_no_reg=-3954.6161, loss_reg=0.0000

2020-11-06 02:32:27.039883 run epoch 210:  time=19.94s
2020-11-06 02:32:46.981594 loss=-3948.9150, loss_no_reg=-3948.9150, loss_reg=0.0000

2020-11-06 02:32:46.981653 run epoch 211:  time=19.64s
2020-11-06 02:33:06.626721 loss=-3952.5392, loss_no_reg=-3952.5392, loss_reg=0.0000

2020-11-06 02:33:06.626787 evaluate at epoch 211
2020-11-06 02:33:47.305452 hitrate@20=0.3838, recall@20=0.0623, ndcg@20=0.0513
2020-11-06 02:33:47.305541 hitrate@50=0.5802, recall@50=0.1190, ndcg@50=0.0723
2020-11-06 02:33:47.305577 the monitor counts down its patience to 0!
2020-11-06 02:33:47.305622 early stop at epoch 211
```